name: Flutter Web Deploy

on:
  push:
    branches:
      - main
  workflow_dispatch: # Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ

jobs:
  build_and_deploy:
    # ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø¶Ø±ÙˆØ±ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙØ±Ø¹ gh-pages
    permissions:
      contents: write
      pages: write
      id-token: write # ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¶Ø±ÙˆØ±ÙŠØ© Ù„Ù€ GitHub Actions
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
      - uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.19.0'
          
      - run: flutter pub get

      # Ø£Ù…Ø± Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„ÙØ±Ø¹ÙŠ
      - run: flutter build web --release --base-href /lafita/

      # ğŸŒŸ Ø®Ø·ÙˆØ© Ø§Ù„Ù†Ø´Ø± Ø¥Ù„Ù‰ ÙØ±Ø¹ gh-pages ğŸŒŸ
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./build/web
          publish_branch: gh-pages # ÙŠÙ†Ø´Ø± Ø§Ù„Ù…Ù„ÙØ§Øª Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„ÙØ±Ø¹
          
